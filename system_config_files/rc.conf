# FreeBSD 14 ThinkPad T480 /etc/rc.conf configuration
# System startup and service configuration file

# ============================================================================
# SYSTEM BASICS
# ============================================================================

# Clear /tmp directory on boot for security and cleanliness
clear_tmp_enable="YES"

# Set system hostname
hostname="ddevil"

# Set keyboard layout
keymap="pl.kbd"

# ============================================================================
# TIME SYNCHRONIZATION
# ============================================================================

# Enable Network Time Protocol daemon for continuous time sync
ntpd_enable="YES"
ntpd_flags="-g"

# ============================================================================
# POWER MANAGEMENT
# ============================================================================

# Enable powerdxx for advanced power management (preferred over base powerd)
powerdxx_enable="YES"
powerdxx_flags="-a hiadaptive -b adaptive -n hiadaptive"

# Set CPU C-states for performance mode (Cmax = deepest available)
performance_cx_lowest="Cmax"

# Set CPU C-states for economy mode (Cmax = deepest available)
economy_cx_lowest="Cmax"

# Disable base powerd to avoid conflicts with powerdxx
powerd_enable="NO"

# ============================================================================
# HARDWARE DRIVERS
# ============================================================================

# Load graphics, wireless, and miscellaneous hardware drivers after kernel boot
kld_list="/boot/modules/i915kms.ko if_iwm iwm8265fw fusefs acpi_video acpi_ibm cpufreq coretemp snd_hda cuse"

# ============================================================================
# USB WEBCAM SUPPORT
# ============================================================================

# Enable webcam daemon for USB camera support
webcamd_enable="YES"

# Configure webcam for device ugen0.3 with background operation
webcamd_0_flags="-d ugen0.3 -B"

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================

# Run DHCP client in background for faster boot
background_dhclient="YES"

# Prefer IPv4 connectivity by default while keeping IPv6 available per-interface
ip6addrctl_policy="ipv4_prefer"

# Configure wired ethernet (em0) for DHCP
ifconfig_em0="DHCP"

# Enable IPv6 router advertisements on wired interface
ifconfig_em0_ipv6="inet6 accept_rtadv"

# Create wlan0 interface from iwm0 wireless device with Polish regulatory domain
wlans_iwm0="wlan0"
create_args_wlan0="country PL regdomain ETSI"

# Configure wireless for WPA authentication, DHCP, and power saving
ifconfig_wlan0="WPA powersave DHCP"

# Enable IPv6 router advertisements on wireless interface
ifconfig_wlan0_ipv6="inet6 accept_rtadv"

# Wait 5 seconds before setting default route (helps with network timing)
defaultrouter_delay="5"

# ============================================================================
# INPUT DEVICES
# ============================================================================

# Disable moused for non-default mice (probably using modern input methods)
moused_nondefault_enable="NO"

# ============================================================================
# STORAGE AND FILESYSTEMS
# ============================================================================

# Enable automatic dump device configuration for crash dumps
dumpdev="AUTO"

# Enable ZFS filesystem support
zfs_enable="YES"

# ============================================================================
# DNS AND SECURITY
# ============================================================================

# Enable local Unbound DNS resolver
local_unbound_enable="YES"

# Enable D-Bus system message bus (required by many desktop applications)
dbus_enable="YES"

# ============================================================================
# SMART CARD SUPPORT
# ============================================================================

# Enable PC/SC daemon for smart card readers
pcscd_enable="YES"

# Disable PolicyKit integration for pcscd (simpler permission model)
pcscd_flags="--disable-polkit"
